---
title: "R Practice"
author: "NDP"
date: '2022-06-02'
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

## Intro to Markdown

Markdown allows you to do things like **bold**, *italic*, and more!

Make a list with asterisks like: 
\* bold with double-asterisks
\* italics with underscores
\* code-type fond with backticks

You can also use hyphens instead of asterisks.

For a numbere list: 
1. bold.... 
1. italic.... 
1. code....

Load gapminder data in along with plotting package

#This line will not run

Hyperlinks are like [hyperlinked texts] (https://mylink.org)

```{r load_data}
gap <- gapminder
```

```{r make-plot}
plot(lifeExp ~ year, data=gap)
```
```{r}
temp <- c(1,2,3)
```

```{r make_cats}
cats <- data.frame(coat = c("calico","black","tabby"),weight=c(2.1, 5.0, 3.2), likes_string = c(1, 0, 1))
write.csv(x = cats, file = "data/feline-data.csv", row.names=FALSE)
```

```{r read_cats}
cats2 <- read.csv("data/feline-data.csv",stringsAsFactors = T)
```


Creating vectors and coercing types

```{r}
names(cats)[3] <- "likes_hunting"
```
names(cats)[3] <- "likes_hunting"




Add columns and rows to a df

```{r}
cats <- read.csv("data/feline-data.csv")
age <- c(2,3,5)
cats <- cbind(cats,age)
newRow <- list("tortoiseshell",3.3,TRUE,9)
```



CHALLENGE:
```{r}
human_age <- cats$age * 7
human_age <- as.factor(human_age)
human_age <- as.numeric(as.character(human_age))
human_age/7
```

Remove rows and colums

```{r}
cats$coat <- as.factor(cats$coat)
cats <- rbind(cats,c("white",3.4,0,1))
cats <- cats[-5,]
cats <- na.omit(cats)
cats <- read.csv("data/feline-data.csv")
```

Insert a code chunk using a keyboard shortcut
(CMD-OPT-I)
```{r}
library(readxl)
gapminder <- read_excel("data/gapminder_data.xlsx")
```

Inspecting a dataframe
```{r}
summary(gapminder)
summary(gapminder$lifeExp)

gapminder$country <- factor(gapminder$country)
gapminder$continent <- factor(gapminder$continent)
summary(gapminder)

length(gapminder) #ncol(gapminder)
nrow(gapminder)
colnames(gapminder)

head(gapminder)
tail(gapminder)
gapminder[sample(nrow(gapminder),10)]
gapminder[1:10,2:5]
```
## Subsetting data

```{r}
x <- c(5.4,6.2,7.1,4.8,7.5)
names(x) <- c("a","b","c","d","e")

x[c(1,3)] #discrete items
x[1:3] #slice
x[c(1,1,3)]
x[6] #NA - beyond the end
x[-2]
x[c(-1,-5)]
x[-c(1,5)]
x[-(1:3)]
x <- x[-4]
#by name
x[c("a","c")]
x <- c(5.4,6.2,7.1,4.8,7.5)
names(x) <- c("a","b","c","d","e")
x[x>7 | x<7.5] #or
x[x>7 & x<7.5] #and

x2 <- 1:3
names(x2) <- c("a","a","a")
x2["a"] #duplicate names are possible but not advisable

x
x[! names(x) %in% c("a","c")]
```
Select southeast Asian countries from gapminder
```{r}
seAsia <- c("Myanmar","Thailand","Cambodia","Vietnam","Laos")
gapminder[which(gapminder$country %in% seAsia),]
gapminder[gapminder$country %in% seAsia,]
```

Extract observations from the 1960's
```{r}
gap_60s <- gapminder[gapminder$year>1959 & gapminder$year<1970,]
```

**PICTURES!!!!!**
```{r}
library(ggplot2)
ggplot(data=gapminder,mapping=aes(x=gdpPercap,y=lifeExp)) + geom_point()
```

```{r}
#This creates axis, not figure
ggplot(data=gapminder,mapping=aes(x=gdpPercap,y=lifeExp))
```

```{r}
ggplot(data=gapminder,mapping=aes(x=year,y=lifeExp)) + geom_point()
```

LINES!!
```{r}
ggplot(data=gapminder,mapping=aes(x=year,y=lifeExp, color=continent)) + geom_line()
```

Lines that make a little sense
```{r}
ggplot(data=gapminder,mapping=aes(x=year,y=lifeExp,by=country)) + geom_line(mapping=aes(color=continent)) + geom_point(color="yellow")
```

```{r}
logged_points <- ggplot(gapminder,mapping=aes(x=gdpPercap,y=lifeExp)) + geom_point() + scale_x_log10() 
```

```{r}
logged_points + geom_smooth(method="loess")
```

```{r}
americas <- gapminder[gapminder$continent=="Americas",]
ggplot(data=americas,mapping=aes(x=year,y=lifeExp)) + geom_line() + facet_wrap(~country) + theme(axis.text.x=element_text(angle=45))

ggsave(filename="results/lifeExp_americas.png")
```
Save Americas
```{r}
write.csv(file="clean_data/americas_gap.csv",x=americas,row.names=F)
```

dplyr!
```{r}
#we tried to get mean for africa
#mean(gapminder[gapminder$continent=="Africa","gdpPercap"])
```
```{r}
library("dplyr")
year_country_gdp <- select(gapminder,year,country,gdpPercap)
str(year_country_gdp)
smaller_gap <- gapminder %>% select(-continent) %>% rename(gdp_per_capita = gdpPercap)
```

```{r}
y_cntr_gdp_eur <- gapminder %>% filter(continent=="Europe") %>% select(year, country, gdpPercap)
```

Combine with grouping
```{r}
#he moved too fast
#gapminder %>% group_by(continent,year) %>% summarize(mean_gdpPercap = mean(gdpPercap),st_gdpPercap = sd(gdpPercap) 
                                                     
```
Mutate!
```{r}
gapminder %>% mutate(gdp_billion = gdpPercap*pop/10^9) %>% group_by(continent,year) %>% summarize(mean_gdp_bill = mean(gdp_billion))
```

Combine dplyr with ggplot

```{r}
gapminder %>% filter(continent=="Americas") %>% ggplot(mapping = aes(x=year,y=lifeExp)) + geom_line() + facet_wrap(~country)
```
